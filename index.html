<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>吳于安律師 評價｜企業主見證（優先）＋ Google 評論查證（非官方）</title>
<meta name="description" content="本頁以 GitHub Issues 為唯一資料源，優先展示 9 位具名企業主的真實見證；Google 評論僅顯示處理後的主題與查證連結，不複製原文，符合搜尋與平台規範。">
<link rel="canonical" href="https://lawyer-review.25min.co/">
<meta name="robots" content="index,follow">
<meta name="theme-color" content="#0b6cff">

<!-- 結構化資料：QAPage + HowTo（安全，不標星等） -->
<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@type":"QAPage",
  "mainEntity":{
    "@type":"Question",
    "name":"吳于安律師評價如何？",
    "acceptedAnswer":{
      "@type":"Answer",
      "text":"本頁以可追溯的 GitHub Issues 為資料源，優先展示 9 位具名企業主的真實見證；Google 評論僅顯示處理後的主題標籤與查證連結，不複製原文。"
    }
  }
}
</script>
<script type="application/ld+json">
{
  "@context":"https://schema.org",
  "@type":"HowTo",
  "name":"如何查證 Google 上的公開評論",
  "description":"不複製第三方評論原文，指引用戶前往 Google 商家頁閱讀。",
  "step":[
    {"@type":"HowToStep","name":"開啟 Google 地圖","text":"maps.google.com 或 Google 地圖 App。"},
    {"@type":"HowToStep","name":"搜尋","text":"輸入「鴻安法律事務所 吳于安」。"},
    {"@type":"HowToStep","name":"瀏覽評論","text":"點「評論」，可用『最新』或『最高評分』篩選。"},
    {"@type":"HowToStep","name":"交叉核對","text":"留意日期、情境；必要時對照官方頁與可公開自述。"}
  ]
}
</script>

<style>
:root{
  --bg:#0b1220; --fg:#e6edf7; --muted:#93a4b8; --card:#0f172a; --line:#1f2a44; --brand:#4ea1ff;
  --chip:#132338; --chipbd:#1f2a44; --ok:#10b981; --warn:#f59e0b;
}
@media (prefers-color-scheme: light){
  :root{ --bg:#fafafa; --fg:#0f172a; --muted:#667085; --card:#ffffff; --line:#e2e8f0; --brand:#0b6cff; --chip:#f1f5ff; --chipbd:#e2e8f0; }
}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--fg);font:16px/1.65 system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans TC",Arial,sans-serif}
a{color:var(--brand);text-decoration:none} a:hover{text-decoration:underline}
.wrap{max-width:1100px;margin:0 auto;padding:18px}
header{border-bottom:1px solid var(--line)}
.hero{padding:12px 0}
.hero h1{margin:0 0 6px;font-size:26px}
.hero p{margin:0;color:var(--muted)}
.ctas{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
.btn{display:inline-flex;gap:8px;align-items:center;padding:9px 12px;border-radius:10px;border:1px solid var(--line);background:var(--card);color:var(--fg);font-weight:700}
.btn.primary{background:var(--brand);color:#fff;border-color:color-mix(in oklch, var(--brand), #000 10%)}
main{padding:20px 0}
.section{margin:20px 0}
h2{font-size:22px;margin:0 0 10px}
.note{background:var(--chip);border:1px solid var(--chipbd);border-radius:10px;padding:10px;color:var(--muted)}
.list{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px}
@media (max-width:900px){.list{grid-template-columns:1fr}}
.card{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:14px}
.item{display:flex;flex-direction:column;gap:6px;border:1px solid var(--line);border-radius:12px;padding:12px;background:var(--bg)}
.item h3{margin:0;font-size:16px}
.meta{color:var(--muted);font-size:12px;display:flex;gap:8px;flex-wrap:wrap}
.pills{display:flex;gap:6px;flex-wrap:wrap}
.pill{font-size:12px;border:1px solid var(--line);border-radius:999px;padding:3px 8px;background:var(--card);color:var(--muted)}
.kbd{font-family:ui-monospace,Menlo,Consolas,monospace;background:#111827;color:#e5e7eb;border-radius:6px;padding:2px 6px}
.center{display:flex;justify-content:center}
.small{font-size:13px}
.hr{border:none;border-top:1px dashed var(--line);margin:12px 0}
.stat{display:flex;gap:8px;align-items:center;color:var(--muted)}
.dot{width:8px;height:8px;border-radius:50%}
.dot.ok{background:var(--ok)} .dot.warn{background:var(--warn)}
</style>
</head>
<body>
<header>
  <div class="wrap hero">
    <h1>吳于安律師 評價｜企業主見證（優先）＋ Google 查證入口</h1>
    <p>資料源：<span class="kbd">GitHub Issues</span>（可追溯）。不複製 Google 原文。</p>
    <div class="ctas">
      <a class="btn primary" href="https://github.com/bless25min/taipei-lawyer-recommendation/issues/new/choose" target="_blank" rel="noopener">✍️ 提交新回饋</a>
      <a class="btn" href="https://github.com/bless25min/taipei-lawyer-recommendation/issues" target="_blank" rel="noopener">📁 檢視所有 Issues</a>
      <a class="btn" href="https://www.google.com/search?q=%E5%90%B3%E4%BA%8E%E5%AE%89+%E5%BE%8B%E5%B8%AB+%E8%A9%95%E5%83%B9" target="_blank" rel="noopener">⭐ 到 Google 查評論</a>
    </div>
  </div>
</header>

<main class="wrap" id="main">
  <!-- A. 9 位具名企業主（優先） -->
  <section id="owners" class="section" data-chunk-id="owners" data-topic="owner-priority">
    <h2>企業主真實見證（優先顯示 9 位）</h2>
    <p class="note small">挑選規則：帶有 <span class="kbd">企業主</span>/<span class="kbd">具名</span>/<span class="kbd">named</span> 標籤的 Issue 優先；不足 9 則時，以非 Google 來源補滿。</p>
    <div id="ownersList" class="list">
      <div class="card center" style="grid-column:1/-1">讀取中…</div>
    </div>
  </section>

  <!-- B. Google 公開評論（處理後） -->
  <section id="google" class="section" data-chunk-id="google-processed" data-topic="google-processed">
    <h2>Google 公開評論（處理後展示，不含原文）</h2>
    <div class="card">
      <div id="googleList" class="list">
        <div class="card center" style="grid-column:1/-1">整理中…</div>
      </div>
      <div class="center" style="margin-top:10px"><button id="moreGoogle" class="btn">載入更多</button></div>
    </div>
    <p class="small" style="color:var(--muted);margin-top:8px">說明：Google 來源僅顯示主題標籤與查證連結，不顯示任何原文與星等。</p>
  </section>

  <section class="section" data-chunk-id="method" data-topic="methodology">
    <h2>方法與合規</h2>
    <div class="card">
      <ul class="small">
        <li>資料來源以 GitHub Issues 為主；每則卡片保留到原始 Issue 的連結。</li>
        <li>Google 評論不顯示原文與星等；只提供查證入口與主題標籤。</li>
        <li>頁面不使用 Review/AggregateRating 的結構化資料。</li>
      </ul>
    </div>
  </section>
</main>

<footer class="wrap" style="border-top:1px solid var(--line);padding-top:14px;color:var(--muted)">
  © 客戶見證整理（非官方） · 最後更新：<span id="lastmod"></span>
</footer>

<noscript>
本頁需要 JavaScript 才能即時載入 Issues。若你無法啟用，請直接前往
<a href="https://github.com/bless25min/taipei-lawyer-recommendation/issues" target="_blank" rel="noopener">GitHub Issues</a> 檢視全部評價。
</noscript>

<script>
/* ===== 可調參數（依你的標籤命名而定） ===== */
const REPO = "bless25min/taipei-lawyer-recommendation";
const OWNER_LABELS  = [/企業主/i, /具名/i, /named/i];                 // 置頂的 9 則以此為準
const CUSTOMER_LABS = [/client-feedback/i, /用戶自主上傳評價/i, /原創/i];
const GOOGLE_LABS   = [/google-review/i, /google評價/i, /來源:google/i, /^google$/i];
const OWNERS_LIMIT  = 9;
const GOOGLE_PAGE   = 12;

/* ===== 工具 ===== */
const $ = (q,el=document)=>el.querySelector(q);
const h = (html)=>{const t=document.createElement('template');t.innerHTML=html.trim();return t.content.firstElementChild;};
const esc = (s)=>String(s||"").replace(/[&<>"'`]/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;','`':'&#96;'}[c]));
const hasAny=(names, pats)=> (names||[]).some(n=>pats.some(p=>p.test(n)));

/* 來源分類（雙保險：即使沒有 /api/reviews 也能在前端判斷） */
function classifyByLabels(labels=[], title=""){
  if (hasAny(labels, GOOGLE_LABS) || /\[?google[^\]]*評價\]?/i.test(title)) return 'google';
  if (hasAny(labels, CUSTOMER_LABS)) return 'customer';
  return 'unspecified';
}
function isOwner(labels=[], title=""){
  if (hasAny(labels, OWNER_LABELS)) return true;
  // 補充規則：標題含公司/職稱字樣也視為具名（避免漏抓）
  return /公司|股份有限|有限公司|行號|工作室|先生|小姐|經理|負責人|董事|CEO|CTO/i.test(title);
}

/* 清洗文字，控制長度；Google 來源一律不顯示正文 */
function safeExcerpt(source, body, n=360){
  if (source==='google') return "";   // 不顯示任何 Google 原文
  const s = String(body||"").trim().replace(/\s{2,}/g,' ');
  return s.length<=n ? s : s.slice(0,n-1)+'…';
}

/* UI 卡片 */
function ownerCard(it){
  const labels = it.labels.map(n=>`<span class="pill">${esc(n)}</span>`).join(" ");
  return h(`
    <article class="item" data-chunk-id="owner-${it.number}" data-topic="owner" data-asof-date="${it.date}" data-source-url="${it.url}">
      <h3>${esc(it.title||'（無標題）')}</h3>
      <div class="meta"><span>#${it.number}</span><span>建立：${it.date}</span><a href="${it.url}" target="_blank" rel="noopener">來源：Issue</a></div>
      ${it.excerpt ? `<div>${esc(it.excerpt)}</div>` : `<div class="meta">（提交者未提供內文）</div>`}
      <div class="pills">${labels}</div>
      <div class="meta"><a class="pill" href="${it.url}" target="_blank" rel="noopener">閱讀完整內容 →</a></div>
    </article>
  `);
}
function googleCard(it){
  // 只露出主題標籤與查證連結（濾掉『google』類標籤與自述標籤）
  const useful = it.labels.filter(n=>!GOOGLE_LABS.some(p=>p.test(n)) && !CUSTOMER_LABS.some(p=>p.test(n)));
  const chips = (useful.length? useful.slice(0,6) : ['Google 公開評論']).map(n=>`<span class="pill">${esc(n)}</span>`).join(" ");
  return h(`
    <article class="item" data-chunk-id="google-${it.number}" data-topic="google" data-asof-date="${it.date}" data-source-url="${it.url}">
      <h3>Google 公開評論（處理後）</h3>
      <div class="meta"><span>#${it.number}</span><span>建立：${it.date}</span></div>
      <div class="pills">${chips}</div>
      <div class="meta">
        <a class="pill" href="${it.url}" target="_blank" rel="noopener">前往 Issue 查證</a>
        <a class="pill" href="https://www.google.com/search?q=%E5%90%B3%E4%BA%8E%E5%AE%89+%E5%BE%8B%E5%B8%AB+%E8%A9%95%E5%83%B9" target="_blank" rel="noopener">到 Google 查看</a>
      </div>
      <small class="small" style="color:var(--muted)">本卡片不顯示 Google 原文與星等；請於 Google 商家頁閱讀完整內容。</small>
    </article>
  `);
}

/* 載入資料：優先 /api/reviews，失敗則回退 GitHub API */
async function loadIssues(){
  // A) 你的 Pages Functions
  try{
    const r = await fetch('/api/reviews',{credentials:'omit'});
    if(r.ok){
      const js = await r.json();
      if(js && Array.isArray(js.items)){
        return js.items.map(x=>({
          number:x.number,
          title:x.title||'(無標題)',
          labels:x.labels||[],
          created_at:x.created_at,
          url:x.html_url,
          source:x.source || classifyByLabels(x.labels||[], x.title||''),
          body:x.safe_excerpt || ''  // 伺服端已裁切過；Google 來源多半為空字串
        }));
      }
    }
  }catch(e){/* 忽略，回退 GitHub */}
  // B) 回退 GitHub API
  const r = await fetch(`https://api.github.com/repos/${REPO}/issues?state=open&per_page=100`, {headers:{'Accept':'application/vnd.github+json'}});
  const arr = await r.json();
  return (Array.isArray(arr)?arr:[])
    .filter(x=>!x.pull_request)
    .map(x=>{
      const labels=(x.labels||[]).map(l=>l.name);
      const source=classifyByLabels(labels, x.title||'');
      return {
        number:x.number,
        title:x.title||'(無標題)',
        labels,
        created_at:x.created_at,
        url:x.html_url,
        source,
        body:x.body||''
      };
    });
}

/* 主程式 */
document.getElementById('lastmod').textContent = new Date().toISOString().slice(0,10);

(async function(){
  const ownersBox = $('#ownersList');
  const googleBox = $('#googleList');
  const moreBtn = $('#moreGoogle');

  let items = await loadIssues();
  // 正規化
  items = items.map(d=>({
    number:d.number,
    title:d.title,
    labels:d.labels||[],
    date:new Date(d.created_at).toISOString().slice(0,10),
    url:d.url,
    source:d.source,
    excerpt:safeExcerpt(d.source, d.body, 360)
  }));

  // A) 企業主 9 位（優先：有 OWNER_LABELS；不足再補 customer/unspecified，排除 google）
  const poolOwner = items.filter(i => i.source!=='google');
  const strictOwners = poolOwner.filter(i => isOwner(i.labels, i.title));
  const owners = (strictOwners.length ? strictOwners : poolOwner)
                  .sort((a,b)=>new Date(b.date)-new Date(a.date))
                  .slice(0, OWNERS_LIMIT);

  ownersBox.innerHTML = "";
  if(!owners.length){
    ownersBox.append(h(`<div class="card center" style="grid-column:1/-1">目前尚無「企業主」標籤的見證。請在想置頂的 Issue 加上 <span class="kbd">企業主</span> 或 <span class="kbd">具名</span>。</div>`));
  }else{
    const frag = document.createDocumentFragment();
    owners.forEach(it=>frag.append(ownerCard(it)));
    ownersBox.append(frag);
  }

  // B) Google（處理後；不含原文）
  const googles = items.filter(i=>i.source==='google').sort((a,b)=>new Date(b.date)-new Date(a.date));
  let gPage = 0;
  function renderGoogle(){
    const start=gPage*GOOGLE_PAGE, end=start+GOOGLE_PAGE;
    const slice=googles.slice(start,end);
    if(gPage===0) googleBox.innerHTML="";
    const frag = document.createDocumentFragment();
    slice.forEach(it=>frag.append(googleCard(it)));
    googleBox.append(frag);
    gPage++;
    if(end>=googles.length) moreBtn.style.display='none';
  }
  moreBtn.addEventListener('click', renderGoogle);
  renderGoogle();
})();
</script>
</body>
</html>
